<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <link rel="stylesheet" href="node_modules/bootstrap/dist/css/bootstrap.min.css">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>АТБ - магазин</title>
</head>
<body>
    <h1 class="text-center">Користувачів</h1>
    
    <div class="container">
        <a href="/Classwork/5. Validation Form/" class="btn btn-link">На головну</a>

        <div class="row">
            <div class="col-10 mx-auto" >
                <table class="table" id="table">
                    <thead id="usersTableHead">
                        <!-- <tr>
                            <th scope="col">#</th>
                            <th scope="col">Фото</th>
                            <th scope="col">ПІБ</th>
                            <th scope="col">Тулефон</th>
                            <th scope="col">Пошта</th>
                        </tr> -->
                    </thead>
                    <tbody id="usersTableBody">
                        <!-- <tr id="tr">
                            <th scope="row">1</th>
                            <td>
                                <img src=""
                                alt="Козак"
                                width="75px">
                            </td>
                            <td>Юхим Роман</td>
                            <td>+380 98 998 77 32</td>
                            <td>dfggfhh@gmail.com</td>
                        </tr> -->
                    </tbody>
                </table>
                <div class="container text-center">
                    <button class="btn btn-primary" id="btnXHR">Получити таблицю (XMLHttpRequest)</button>
                </div>
                
            </div>
        </div>
    </div>

    <script>
        console.log("Це JavaScript!");
    </script>

    <script src="node_modules/bootstrap/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>

    <script>
        const xhr = new XMLHttpRequest();
        // Створення нового CMLHttpRequest об'єкта 
        // Зарит виконується асинхронно - true
        xhr.open("GET" ,"https://lohika.itstep.click/api/Users/all",true);

        //Обробляємо коли задача була виконана
        xhr.onload = function() {
            // Тут можна відсліджувати процес проходження запиту
            if (xhr.status === 200) { // Якщо статус 200 - все ок
                
                console.log(xhr.response); // Виводимо відповідь сервера
                const users = JSON.parse(xhr.response); // Парсимо JSON в об'єкт
                console.log("Object users", users); // Виводимо масив об'єктів у консоль 
                vievListUsers(users);
                        
                // btnXHR.addEventListener("click", vievListUsers(users));
            }
        };

        xhr.send(); // Відправляємо запит на сервер

        // btnXHR.addEventListener("click", function(){
        //     const xhr = new XMLHttpRequest();
        //     // Створення нового CMLHttpRequest об'єкта 
        //     // Зарит виконується асинхронно - true
        //     xhr.open("GET" ,"https://lohika.itstep.click/api/Users/all",true);

        //     //Обробляємо коли задача була виконана
        //     // Тут можна відсліджувати процес проходження запиту
        //     if (xhr.status === 200) { // Якщо статус 200 - все ок
                
        //         console.log(xhr.response); // Виводимо відповідь сервера
        //         const users = JSON.parse(xhr.response); // Парсимо JSON в об'єкт
        //         console.log("Object users", users); // Виводимо масив об'єктів у консоль 
        //         vievListUsers(users);
                        
        //         // btnXHR.addEventListener("click", vievListUsers(users));
        //     }

        //     xhr.send(); // Відправляємо запит на сервер
        // });

        const vievListUsers = (listUsers) =>
        {
            const usersTableHead = document.getElementById("usersTableHead");
            usersTableHead.innerHTML = `
                <tr>
                    <th scope="col">#</th>
                    <th scope="col">Фото</th>
                    <th scope="col">ПІБ</th>
                    <th scope="col">Тулефон</th>
                    <th scope="col">Пошта</th>
                </tr>
            `;

            const usersTableBody = document.getElementById("usersTableBody");
                usersTableBody.innerHTML = ""; // Очищаємо таблицю
                //index - це порядковий номер елемента в масиві
                listUsers.forEach((user, index) => {
                    const tr = document.createElement("tr"); // Створюємо рядок таблиці
                    
                    tr.innerHTML = `
                    <tr>
                        <th scope="row"> ${index + 1} </th>
                        <td>
                            <img src="https://lohika.itstep.click/images/100_${user.photo}"
                            alt="Козак"
                            width="75px">
                        </td>
                        <td>${user.secondName} ${user.firstName}</td>
                        <td>${user.photo}</td>
                        <td>${user.email}</td>
                    </tr> `; // Заповнюємо рядок даними користувача
                    usersTableBody.appendChild(tr); // Додаємо рядок в таблицю  
                });
        }

    </script>

    <script>
        const student = {
            name: "Іван",
            age: 21,
            isMarried: false,
            scores: [90,81,42],
            address: {
                city: "Київ",
                street: "Хрищатик",
                houseNumber: 10
            }
        };
        console.log("Об'єкт student:", student);

        // Перетворення об'єкта в JSON-рядок
        const studentJSON = JSON.stringify(student);
        console.log("JSON-рядок studentJSON:", studentJSON);
        
        // Перетворення JSON-рядока в об'єкт
        const parsedStudent = JSON.stringify(student);
        console.log("JSON-рядок parsedStudent:", parsedStudent);
    </script>
</body>
</html>